{"version":19,"variables":[],"tiles":{"0":{"type":"markdown","content":"# Top User Logon Failures"},"1":{"type":"markdown","content":"# Logon Failures (logs)"},"4":{"type":"markdown","content":"# Locked Out Users"},"5":{"type":"markdown","content":"# Password Changes"},"7":{"title":"","type":"data","query":"// Count of Failed Logons //\nfetch logs //, scanLimitGBytes: 500, samplingRatio: 1000\n| filter matchesValue(winlog.eventid, \"4625\")\n| filterout matchesPhrase(content, \"The EventSystem sub system is suppressing duplicate event log entries for a duration of 86400 seconds\")\n| summarize event_count = count()","visualization":"singleValue","visualizationSettings":{"singleValue":{"labelMode":"none","label":"event_count","recordField":"event_count","isIconVisible":true,"prefixIcon":"CriticalFailedIcon","trend":{"isVisible":true,"trendField":"event_count"}},"autoSelectVisualization":false,"thresholds":[{"id":1,"field":"event_count","title":"","isEnabled":true,"rules":[{"id":2,"color":{"Default":"var(--dt-colors-charts-status-critical-default, #c4233b)"},"comparator":"≥","label":"","value":1}]}]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"8":{"type":"markdown","content":"# Failed logins"},"9":{"title":"","type":"data","query":"// Count of Failed Logons //\nfetch logs //, scanLimitGBytes: 500, samplingRatio: 1000\n| filter matchesValue(winlog.eventid, \"4740\")\n| filterout matchesPhrase(content, \"The EventSystem sub system is suppressing duplicate event log entries for a duration of 86400 seconds\")\n| summarize event_count = count()","visualization":"singleValue","visualizationSettings":{"singleValue":{"labelMode":"none","label":"event_count","recordField":"event_count","isIconVisible":true,"prefixIcon":"LockIcon","trend":{"isVisible":true,"trendField":"event_count"}},"autoSelectVisualization":false,"thresholds":[{"id":1,"field":"event_count","title":"","isEnabled":true,"rules":[{"id":1,"color":{"Default":"var(--dt-colors-charts-categorical-color-01-default, #134fc9)"},"comparator":"≥","label":"","value":1}]}]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"10":{"title":"","type":"data","query":"fetch logs //, scanLimitGBytes: 500, samplingRatio: 1000\n| filter matchesValue(winlog.eventid, \"4625\")\n| filterout matchesPhrase(content, \"The EventSystem sub system is suppressing duplicate event log entries for a duration of 86400 seconds\")\n| parse content, \"\"\"LD:'logcontent'EOL\nLD EOL\nLD EOL\nLD SPACE LD ':' LD: 'Subject_SecurityID' EOL\nLD ':' LD: 'Subject_AccountName' EOL\nLD ':' LD: 'Subject_AccountDomain' EOL\nLD ':' LD: 'Subject_Logon_ID' EOL\nLD EOL\nLD ':' LD: 'Logon_LogonType' EOL\nLD EOL\nLD:'AccountForWhichFailed'EOL\nLD ':' LD: 'NewLogon_SecurityID' EOL\nLD ':' LD: 'NewLogon_AccountName' EOL\nLD ':' LD: 'NewLogon_AccountDOmain' EOL\nLD EOL\nLD:'FailureInfo'EOL\nLD ':' LD: 'FailureReason ' EOL\nLD ':' LD: 'Status ' EOL\nLD \":\" LD: 'SubStatus' EOL\nLD EOL\nLD:'ProcessInfo'EOL\nLD ':' LD: 'Process_ProcessID' EOL\nLD ':' LD: 'Process_ProcessName' EOL\nLD EOL\nLD ':' LD: 'Network_Workstation_Name' EOL\nLD ':' LD: 'Network_SourceNetworkAddress' EOL\nLD ':' LD: 'Network_SourcePort' EOL\nLD EOL\nLD EOL\nLD ':' LD: 'Auth_LogonProcess' EOL\nLD ':' LD: 'Auth_AuthenticationPackage' EOL\nLD ':' LD: 'Auth_TransitedServices' EOL\nLD ':' LD: 'Auth_Package_Name' EOL\nLD ':' LD: 'Auth_KeyLength' EOL\nLD EOL\"\"\"\n| fields AccountName=NewLogon_AccountName\n| filterOut contains(AccountName, \"$\")\n| summarize count(),by:AccountName","visualization":"table","visualizationSettings":{"table":{"columnTypeOverrides":[{"fields":["content"],"id":1730695769904,"value":"log-content"}],"sortBy":{"columnId":"[\"count()\"]","direction":"descending"},"columnWidths":{"[\"AccountName\"]":211.2954559326172}},"autoSelectVisualization":false,"thresholds":[]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"11":{"title":"Lockout Detail","type":"data","query":"fetch logs //, scanLimitGBytes: 500, samplingRatio: 1000\n| filter matchesValue(winlog.eventid, \"4625\")\n| filterout matchesPhrase(content, \"The EventSystem sub system is suppressing duplicate event log entries for a duration of 86400 seconds\")\n| parse content, \"\"\"LD:'logcontent'EOL\nLD EOL\nLD EOL\nLD SPACE LD ':' LD: 'Subject_SecurityID' EOL\nLD ':' LD: 'Subject_AccountName' EOL\nLD ':' LD: 'Subject_AccountDomain' EOL\nLD ':' LD: 'Subject_Logon_ID' EOL\nLD EOL\nLD ':' LD: 'Logon_LogonType' EOL\nLD EOL\nLD:'AccountForWhichFailed'EOL\nLD ':' LD: 'NewLogon_SecurityID' EOL\nLD ':' LD: 'NewLogon_AccountName' EOL\nLD ':' LD: 'NewLogon_AccountDOmain' EOL\nLD EOL\nLD:'FailureInfo'EOL\nLD ':' LD: 'FailureReason ' EOL\nLD ':' LD: 'Status ' EOL\nLD \":\" LD: 'SubStatus' EOL\nLD EOL\nLD:'ProcessInfo'EOL\nLD ':' LD: 'Process_ProcessID' EOL\nLD ':' LD: 'Process_ProcessName' EOL\nLD EOL\nLD ':' LD: 'Network_Workstation_Name' EOL\nLD ':' LD: 'Network_SourceNetworkAddress' EOL\nLD ':' LD: 'Network_SourceIP' EOL\nLD EOL\nLD EOL\nLD ':' LD: 'Auth_LogonProcess' EOL\nLD ':' LD: 'Auth_AuthenticationPackage' EOL\nLD ':' LD: 'Auth_TransitedServices' EOL\nLD ':' LD: 'Auth_Package_Name' EOL\nLD ':' LD: 'Auth_KeyLength' EOL\nLD EOL\"\"\"\n| fields host.name, Network_SourceNetworkAddress, NewLogon_AccountName, NewLogon_AccountDOmain, timestamp, content","visualization":"table","visualizationSettings":{"table":{"linewrapEnabled":true,"sortBy":{"columnId":"[\"timestamp\"]","direction":"unset"},"columnWidths":{"[\"content\"]":1460,"[\"FailureReason\"]":523.102294921875,"[\"timestamp\"]":342.05,"[\"details\"]":688,"[\"host.name\"]":170.02999877929688,"[\"Network_SourceNetworkAddress\"]":147.852294921875,"[\"NewLogon_AccountDOmain\"]":216},"columnTypeOverrides":[{"fields":["timestamp","count"],"id":1730695769794,"value":"log-content"}]},"autoSelectVisualization":false,"thresholds":[]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"12":{"type":"markdown","content":"# Top Workstation Logon Failures"},"13":{"title":"","type":"data","query":"fetch logs //, scanLimitGBytes: 500, samplingRatio: 1000\n| filter matchesValue(winlog.eventid, \"4625\")\n| filterout matchesPhrase(content, \"The EventSystem sub system is suppressing duplicate event log entries for a duration of 86400 seconds\")\n| parse content, \"\"\"DATA 'Account Name:' DATA:AccountName 'Account Domain:'\nDATA 'Failure Reason:' DATA:FailureReason 'Status'\nDATA 'Workstation Name:' DATA:WorkstationName 'Source Network Address:'\"\"\"\n| fields WorkstationName\n| summarize count(),by:WorkstationName","visualization":"table","visualizationSettings":{"table":{"columnTypeOverrides":[{"fields":["content"],"id":1730695769904,"value":"log-content"}],"sortBy":{"columnId":"[\"count()\"]","direction":"descending"},"columnWidths":{"[\"WorkstationName\"]":178.47727966308594}},"autoSelectVisualization":false,"thresholds":[]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"15":{"type":"markdown","content":"# Top User Lockouts"},"16":{"title":"","type":"data","query":"fetch logs //, scanLimitGBytes: 500, samplingRatio: 1000\n| filter matchesValue(winlog.eventid, \"4740\")\n| filterout matchesPhrase(content, \"The EventSystem sub system is suppressing duplicate event log entries for a duration of 86400 seconds\")\n//| parse content, \"\"\"DATA 'Account Name:' DATA:AccountName 'Account Domain:' DATA 'Failure Reason:' DATA:FailureReason 'Status' DATA 'Workstation Name:' DATA:WorkstationName 'Source Network Address:'\"\"\"\n//| fields AccountName\n//| summarize count(),by:AccountName\n| parse content, \"\"\"//DATA 'Account Name:' DATA:AccountName 'Account Domain:'\nDATA 'Account That Was Locked Out:' DATA:AccountSID_Name 'Additional Information:'\nDATA 'Caller Computer Name:' DATA:LockedOuTryingToAccess \"\"\"\n| fields AccountSID_Name, ClientMachine=LockedOuTryingToAccess, timestamp","visualization":"table","visualizationSettings":{"table":{"columnTypeOverrides":[{"fields":["content"],"id":1730695769904,"value":"log-content"}],"sortBy":{"columnId":"[\"timestamp\"]","direction":"descending"},"columnWidths":{"[\"AccountSID_Name\"]":683}},"autoSelectVisualization":false,"thresholds":[]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"17":{"type":"markdown","content":"# Successful logins"},"18":{"title":"","type":"data","query":"// Count of Failed Logons //\nfetch logs //, scanLimitGBytes: 500, samplingRatio: 1000\n| filter matchesValue(winlog.eventid, \"4624\")\n| filterout matchesPhrase(content, \"The EventSystem sub system is suppressing duplicate event log entries for a duration of 86400 seconds\")\n| summarize event_count = count()","visualization":"singleValue","visualizationSettings":{"singleValue":{"labelMode":"none","label":"event_count","recordField":"event_count","isIconVisible":true,"prefixIcon":"SuccessIcon","trend":{"isVisible":true,"trendField":"event_count"}},"autoSelectVisualization":false,"thresholds":[{"id":1,"field":"event_count","title":"","isEnabled":true,"rules":[{"id":0,"color":{"Default":"var(--dt-colors-charts-categorical-color-09-default, #649438)"},"comparator":"≥","label":"","value":1}]}]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"19":{"title":"User Change","type":"data","query":"// Count of Failed Logons //\nfetch logs //, scanLimitGBytes: 500, samplingRatio: 1000\n| filter matchesValue(winlog.eventid, \"4723\")\n| filterout matchesPhrase(content, \"The EventSystem sub system is suppressing duplicate event log entries for a duration of 86400 seconds\")\n| summarize event_count = count()","visualization":"singleValue","visualizationSettings":{"singleValue":{"labelMode":"none","label":"event_count","recordField":"event_count","prefixIcon":"","trend":{"isVisible":true,"trendField":"event_count"}},"autoSelectVisualization":false,"thresholds":[]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"20":{"title":"Admin Change","type":"data","query":"// Count of Failed Logons //\nfetch logs //, scanLimitGBytes: 500, samplingRatio: 1000\n| filter matchesValue(winlog.eventid, \"4724\")\n| filterout matchesPhrase(content, \"The EventSystem sub system is suppressing duplicate event log entries for a duration of 86400 seconds\")\n| summarize event_count = count()","visualization":"singleValue","visualizationSettings":{"singleValue":{"labelMode":"none","label":"event_count","recordField":"event_count","prefixIcon":"","trend":{"isVisible":true,"trendField":"event_count"}},"autoSelectVisualization":false,"thresholds":[]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"21":{"type":"markdown","content":"# Domain Controllers"},"22":{"title":"","type":"data","query":"fetch dt.entity.host\n| expand tags, alias:tag\n//| fields tag\n| filter tag == \"Application:ActiveDirectory\"\n| summarize count()","visualization":"singleValue","visualizationSettings":{"singleValue":{"labelMode":"none","label":"event_count","recordField":"count()","prefixIcon":"DesktopIcon","trend":{"isVisible":true,"trendType":"custom"}},"autoSelectVisualization":false,"thresholds":[]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"23":{"type":"markdown","content":"# Kerberos Pre-Auth Fails"},"24":{"title":"","type":"data","query":"fetch logs //, scanLimitGBytes: 500, samplingRatio: 1000\n| filter matchesValue(winlog.eventid, \"4771\")\n| filterout matchesPhrase(content, \"The EventSystem sub system is suppressing duplicate event log entries for a duration of 86400 seconds\")\n| parse content, \"\"\"LD:'logcontent'EOL\nLD EOL\nLD EOL\nLD SPACE LD ':' LD: 'Subject_SecurityID' EOL\nLD ':' LD: 'AccountName' EOL\nLD EOL\nLD EOL\nLD EOL\nLD EOL\nLD EOL\nLD '::ffff:' LD: 'RemoteEndpoint' EOL\nLD ':' LD: 'RemotePort' EOL\"\"\"\n| fields AccountName, RemoteEndpoint, timestamp, content\n| filterOut isNull(AccountName)","visualization":"table","visualizationSettings":{"table":{"sortBy":{"columnId":"[\"timestamp\"]","direction":"descending"},"columnWidths":{"[\"AccountSID_Name\"]":231,"[\"AccountName\"]":144,"[\"content\"]":1901},"columnTypeOverrides":[{"fields":["content"],"id":1730695769904,"value":"log-content"}],"columnOrder":["[\"AccountName\"]","[\"RemoteEndpoint\"]","[\"timestamp\"]","[\"content\"]"]},"autoSelectVisualization":false,"thresholds":[]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"25":{"type":"markdown","content":"# Active Directory Host Environment "},"26":{"title":"Average host availability","type":"data","query":"fetch dt.entity.host\n| expand tags, alias:tag\n//| fields tag\n| filter tag == \"Application:ActiveDirectory\"\n| fieldsAdd hostGroupName\n| filterOut isMonitoringCandidate == true or standalone == true\n| lookup [\ntimeseries m1=max(dt.host.availability, rollup: sum),\nfilter:availability.state == \"up\",\nby:{availability.state,dt.entity.host},from: toTimestamp($dt_timeframe_from), to: toTimestamp($dt_timeframe_to)-2m\n| parse replaceString(toString(m1),\"null\",\"0\"), \"\"\"'['ARRAY{ DOUBLE:i ', '}{1,10000}:m1Pop\"\"\"\n| fieldsAdd intervalToMinutes = toLong(interval)/60000000000 \n| fieldsAdd availability= toDouble(arraySum(m1Pop)/(arraySize(m1Pop))*100)/intervalToMinutes],\nsourceField: id, lookupField: dt.entity.host, fields: {availability}\n| fields id, availability=coalesce(availability, 0)\n| summarize avg(availability)\n","visualization":"singleValue","visualizationSettings":{"singleValue":{"labelMode":"none","label":"avg(availability)","recordField":"avg(availability)","prefixIcon":"","trend":{"isVisible":false}},"thresholds":[{"id":1,"field":"","title":"","isEnabled":true,"rules":[{"id":0,"color":{"Default":"var(--dt-colors-charts-categorical-color-09-default, #649438)"},"comparator":"≥","label":"","value":95},{"id":1,"color":{"Default":"var(--dt-colors-charts-categorical-color-14-default, #d56b1a)"},"comparator":"≥","label":"","value":80},{"id":2,"color":{"Default":"var(--dt-colors-charts-categorical-color-12-default, #cd3741)"},"comparator":"≤","label":"","value":80}]}],"unitsOverrides":[{"identifier":"avg(availability)","unitCategory":"unspecified","baseUnit":"none","displayUnit":null,"decimals":2,"suffix":" %","delimiter":false,"added":1701249707791}]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":100,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false}},"27":{"title":"Problematic hosts","type":"data","query":"fetch events, from: toTimestamp($dt_timeframe_to)-6h-10m, to: toTimestamp($dt_timeframe_to)\n             \n             | filter dt.system.bucket == \"default_davis_events\"\n             | filter event.kind == \"DAVIS_PROBLEM\"\n             | filter contains(toString(affected_entity_ids),\"HOST\") or contains(toString(related_entity_ids),\"HOST\")\n             | sort timestamp\n             | summarize {\n                event.start = takeLast(event.start),\n                event.end = takeLast(event.end),\n                dt.davis.is_duplicate = takeLast(dt.davis.is_duplicate),\n                affected_entities=takeLast(affected_entity_ids),\n                event.status = takeLast(event.status),\n                related_entities=takeLast(related_entity_ids)\n               },\n               by:{event.id}\n             | filter isNull(dt.davis.is_duplicate) OR not(dt.davis.is_duplicate)\n             | filter event.status == \"ACTIVE\"\n             | filter isNull(event.end) OR event.end >= toTimestamp($dt_timeframe_to)-6h-10m\n             | filter event.start <= toTimestamp($dt_timeframe_to)\n             | expand affectedEntity = affected_entities\n             | expand related_entity = related_entities\n             | filter startsWith(affectedEntity,\"HOST-\") or startsWith(related_entity,\"HOST-\")\n             | fieldsAdd host = if(startsWith(affectedEntity, \"HOST-\"), affectedEntity, else: related_entity)\n             | summarize arraySize(collectDistinct(event.id)), alias: problems, by:{host}\n             | filter problems > 0 \n             | summarize hosts = countDistinct(host)","visualization":"singleValue","visualizationSettings":{"singleValue":{"labelMode":"none","label":"hosts","recordField":"hosts","prefixIcon":"","trend":{"isVisible":false}},"thresholds":[{"id":1,"field":"","title":"","isEnabled":true,"rules":[{"id":0,"color":{"Default":"var(--dt-colors-charts-categorical-color-09-default, #649438)"},"comparator":"≥","label":""},{"id":1,"color":{"Default":"var(--dt-colors-charts-categorical-color-14-default, #d56b1a)"},"comparator":"≥","label":""},{"id":2,"color":{"Default":"var(--dt-colors-charts-categorical-color-12-default, #cd3741)"},"comparator":">","label":"","value":0}]}]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":100,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false}},"28":{"title":"Domain Controllers","type":"data","query":"fetch dt.entity.host\n| expand tags, alias:tag\n//| fields tag\n| filter tag == \"Application:ActiveDirectory\"\n| summarize count(), alias: hosts","visualization":"singleValue","visualizationSettings":{"singleValue":{"labelMode":"none","label":"hosts","recordField":"hosts","prefixIcon":"","trend":{"isVisible":false}},"thresholds":[]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":100,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false}},"29":{"title":"Network traffic across all hosts","type":"data","query":"timeseries by:{dt.entity.host}, {\n    bytes_rx = avg(dt.host.net.nic.bytes_rx),\n    bytes_tx = avg(dt.host.net.nic.bytes_tx)\n  }\n//| filter contains(dt.entity.name, \"ACTIVE_DIRECTORY\")\n| fieldsAdd intervalSeconds = toLong(interval) / 1000000000\n| fieldsAdd trafficVolume = ((arraySum(bytes_rx) + arraySum(bytes_tx))) * 8 * intervalSeconds\n| fieldsAdd entityName(dt.entity.host)\n| fieldsAdd tags = entityAttr(dt.entity.host, \"tags\")\n| expand tags, alias:tag\n| filter tag == \"Application:ActiveDirectory\"\n//| summarize sum(trafficVolume), alias: traffic_gb","visualization":"lineChart","visualizationSettings":{"chartSettings":{"truncationMode":"middle","leftYAxisSettings":{"label":"NIC bytes received • NIC bytes sent on host","isLabelVisible":true},"xAxisLabel":"timeframe","xAxisScaling":"analyzedTimeframe","tooltip":{"variant":"shared"},"fieldMapping":{"leftAxisValues":["bytes_rx","bytes_tx"],"timestamp":"timeframe"},"gapPolicy":"connect"},"autoSelectVisualization":false,"thresholds":[],"dataMapping":{"displayedFields":["dt.entity.host.name","tag"]}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":100,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false}},"30":{"title":"Total traffic","type":"data","query":"timeseries by:{dt.entity.host}, {\n    bytes_rx = avg(dt.host.net.nic.bytes_rx),\n    bytes_tx = avg(dt.host.net.nic.bytes_tx)\n  }\n| fieldsAdd intervalSeconds = toLong(interval) / 1000000000\n| fieldsAdd trafficVolume = ((arraySum(bytes_rx) + arraySum(bytes_tx))) * 8 * intervalSeconds\n\n| fieldsAdd entityName(dt.entity.host)\n| fieldsAdd tags = entityAttr(dt.entity.host, \"tags\")\n| expand tags, alias:tag\n\n// filter with Application Tags\n| filter tag == \"Application:ActiveDirectory\"\n\n\n| summarize sum(trafficVolume), alias: traffic_gb\n","visualization":"singleValue","visualizationSettings":{"singleValue":{"labelMode":"none","label":"traffic_gb","recordField":"traffic_gb","prefixIcon":"","trend":{"isVisible":false}},"thresholds":[],"unitsOverrides":[{"identifier":"traffic_gb","unitCategory":"data","baseUnit":"byte","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1701249745190}]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":100,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false}},"31":{"title":"Hosts  availability %","type":"data","query":"fetch dt.entity.host\n| expand tags, alias:tag\n| filter tag == \"Application:ActiveDirectory\"\n| fieldsAdd hostGroupName  \n| filterOut isMonitoringCandidate == true or standalone == true\n| lookup [\ntimeseries m1=max(dt.host.availability, rollup: sum),\nfilter:availability.state == \"up\",\nby:{availability.state,dt.entity.host},from: toTimestamp($dt_timeframe_from), to: toTimestamp($dt_timeframe_to)-2m\n| parse replaceString(toString(m1),\"null\",\"0\"), \"\"\"'['ARRAY{ DOUBLE:i ', '}{1,10000}:m1Pop\"\"\"\n| fieldsAdd intervalToMinutes = toLong(interval)/60000000000 \n| fieldsAdd availability= toDouble(arraySum(m1Pop)/(arraySize(m1Pop))*100)/intervalToMinutes],\nsourceField: id, lookupField: dt.entity.host, fields: {availability}\n| fields Name=entity.name, dt.entity.host = id, `Availability %`=coalesce(availability, 0)\n| sort `Availability %` asc\n| limit 10","visualization":"table","visualizationSettings":{"table":{"sortBy":{"columnId":"[\"Name\"]","direction":"ascending"},"columnWidths":{"[\"Name\"]":307.99,"[\"dt.entity.host\"]":229.6699981689453}},"thresholds":[]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":100,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false}},"32":{"type":"markdown","content":"# Logs\n"},"33":{"title":"Logs across all hosts","type":"data","query":"timeseries values = sum(dt.log.status_per_entity_count, default: 0),by: {loglevel=status}","visualization":"barChart","visualizationSettings":{"chartSettings":{"truncationMode":"middle","leftYAxisSettings":{"label":"dt.log.status_per_entity_count","isLabelVisible":true},"xAxisLabel":"timeframe","xAxisScaling":"analyzedTimeframe","colorPalette":"log-level","tooltip":{"variant":"shared"},"seriesOverrides":[{"seriesId":["ERROR"],"override":{"color":{"Default":"var(--dt-colors-charts-loglevel-emergency-default, #ae132d)"}}},{"seriesId":["INFO"],"override":{"color":{"Default":"var(--dt-colors-charts-categorical-color-01-default, #134fc9)"}}},{"seriesId":["NONE"],"override":{"color":{"Default":"var(--dt-colors-charts-categorical-color-02-default, #2c2f3f)"}}},{"seriesId":["WARN"],"override":{"color":{"Default":"var(--dt-colors-charts-categorical-color-06-default, #a9780f)"}}}],"fieldMapping":{"leftAxisValues":["values"],"timestamp":"timeframe"}},"autoSelectVisualization":false,"thresholds":[],"dataMapping":{"displayedFields":["loglevel"]}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":100,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false}},"36":{"title":"Lockouts over Time","type":"data","query":"fetch logs //, scanLimitGBytes: 500, samplingRatio: 1000\n| filter contains(winlog.eventid, \"4624\") OR contains(winlog.eventid, \"4625\")\n| filterout matchesPhrase(content, \"The EventSystem sub system is suppressing duplicate event log entries for a duration of 86400 seconds\")\n| parse content, \"\"\"LD:'logcontent'EOL\nLD EOL\nLD EOL\nLD SPACE LD ':' LD: 'Subject_SecurityID' EOL\nLD ':' LD: 'Subject_AccountName' EOL\nLD ':' LD: 'Subject_AccountDomain' EOL\nLD ':' LD: 'Subject_Logon_ID' EOL\nLD EOL\nLD ':' LD: 'Logon_LogonType' EOL\nLD EOL\nLD:'AccountForWhichFailed'EOL\nLD ':' LD: 'NewLogon_SecurityID' EOL\nLD ':' LD: 'NewLogon_AccountName' EOL\nLD ':' LD: 'NewLogon_AccountDOmain' EOL\nLD EOL\nLD:'FailureInfo'EOL\nLD ':' LD: 'FailureReason ' EOL\nLD ':' LD: 'Status ' EOL\nLD \":\" LD: 'SubStatus' EOL\nLD EOL\nLD:'ProcessInfo'EOL\nLD ':' LD: 'Process_ProcessID' EOL\nLD ':' LD: 'Process_ProcessName' EOL\nLD EOL\nLD ':' LD: 'Network_Workstation_Name' EOL\nLD ':' LD: 'Network_SourceNetworkAddress' EOL\nLD ':' LD: 'Network_SourceIP' EOL\nLD EOL\nLD EOL\nLD ':' LD: 'Auth_LogonProcess' EOL\nLD ':' LD: 'Auth_AuthenticationPackage' EOL\nLD ':' LD: 'Auth_TransitedServices' EOL\nLD ':' LD: 'Auth_Package_Name' EOL\nLD ':' LD: 'Auth_KeyLength' EOL\nLD EOL\"\"\"\n| fieldsAdd winlog.eventid = toDouble(winlog.eventid)\n| fieldsAdd winlog.eventid.text = if(winlog.eventid == 4624, \"Success\", else: \"Failure\")\n| fields host.name, Network_SourceNetworkAddress, NewLogon_AccountName, NewLogon_AccountDOmain, timestamp, content, winlog.eventid, winlog.eventid.text\n| makeTimeseries count(), by: winlog.eventid.text, time:{timestamp}, interval:5m","visualization":"barChart","visualizationSettings":{"chartSettings":{"xAxisIsLabelVisible":true,"colorPalette":"fireplace-inverted","seriesOverrides":[{"seriesId":["Success"],"override":{"color":{"Default":"var(--dt-colors-charts-categorical-color-09-default, #649438)"},"geometry":"bar"}},{"seriesId":["Failure"],"override":{"color":{"Default":"var(--dt-colors-charts-loglevel-emergency-default, #ae132d)"},"geometry":"bar"}}]},"autoSelectVisualization":false,"thresholds":[]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"37":{"type":"markdown","content":"# Sign-in activity monitoring\nThis dashboard is designed to provide a summary of success and failure logins, lockouts and more across your Windows workloads"},"38":{"title":"Total Sign-ins Captured","type":"data","query":"fetch logs //, scanLimitGBytes: 500, samplingRatio: 1000\n| filter contains(winlog.eventid, \"4624\") OR contains(winlog.eventid, \"4625\")\n| filterout matchesPhrase(content, \"The EventSystem sub system is suppressing duplicate event log entries for a duration of 86400 seconds\")\n| parse content, \"\"\"LD:'logcontent'EOL\nLD EOL\nLD EOL\nLD SPACE LD ':' LD: 'Subject_SecurityID' EOL\nLD ':' LD: 'Subject_AccountName' EOL\nLD ':' LD: 'Subject_AccountDomain' EOL\nLD ':' LD: 'Subject_Logon_ID' EOL\nLD EOL\nLD ':' LD: 'Logon_LogonType' EOL\nLD EOL\nLD:'AccountForWhichFailed'EOL\nLD ':' LD: 'NewLogon_SecurityID' EOL\nLD ':' LD: 'NewLogon_AccountName' EOL\nLD ':' LD: 'NewLogon_AccountDOmain' EOL\nLD EOL\nLD:'FailureInfo'EOL\nLD ':' LD: 'FailureReason ' EOL\nLD ':' LD: 'Status ' EOL\nLD \":\" LD: 'SubStatus' EOL\nLD EOL\nLD:'ProcessInfo'EOL\nLD ':' LD: 'Process_ProcessID' EOL\nLD ':' LD: 'Process_ProcessName' EOL\nLD EOL\nLD ':' LD: 'Network_Workstation_Name' EOL\nLD ':' LD: 'Network_SourceNetworkAddress' EOL\nLD ':' LD: 'Network_SourceIP' EOL\nLD EOL\nLD EOL\nLD ':' LD: 'Auth_LogonProcess' EOL\nLD ':' LD: 'Auth_AuthenticationPackage' EOL\nLD ':' LD: 'Auth_TransitedServices' EOL\nLD ':' LD: 'Auth_Package_Name' EOL\nLD ':' LD: 'Auth_KeyLength' EOL\nLD EOL\"\"\"\n//| fields winlog.eventid if(winlog.eventid = 4624, \"Success\") OR if(winlog.eventid = 4625, \"Failure\") \n| fieldsAdd winlog.eventid = toDouble(winlog.eventid)\n| fieldsAdd winlog.eventid.text = if(winlog.eventid == 4624, \"Success\", else: \"Failure\")\n| fields host.name, Network_SourceNetworkAddress, NewLogon_AccountName, NewLogon_AccountDOmain, timestamp, content, winlog.eventid, winlog.eventid.text\n| summarize count(), by: winlog.eventid.text","visualization":"donutChart","visualizationSettings":{"chartSettings":{"legend":{"position":"right"},"colorPalette":"fireplace-inverted","categoryOverrides":{"Failure":{"color":{"Default":"var(--dt-colors-charts-loglevel-emergency-default, #ae132d)"},"added":1012094.5999999978},"Success":{"color":{"Default":"var(--dt-colors-charts-categorical-color-09-default, #649438)"},"added":1005627.3999999985}}},"autoSelectVisualization":false,"thresholds":[]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}}},"layouts":{"0":{"x":0,"y":27,"w":8,"h":1},"1":{"x":0,"y":38,"w":7,"h":1},"4":{"x":8,"y":18,"w":4,"h":1},"5":{"x":13,"y":10,"w":8,"h":1},"7":{"x":8,"y":15,"w":4,"h":3},"8":{"x":8,"y":14,"w":4,"h":1},"9":{"x":8,"y":19,"w":4,"h":3},"10":{"x":0,"y":28,"w":9,"h":5},"11":{"x":0,"y":39,"w":22,"h":6},"12":{"x":9,"y":27,"w":10,"h":1},"13":{"x":9,"y":28,"w":8,"h":5},"15":{"x":0,"y":22,"w":8,"h":1},"16":{"x":0,"y":23,"w":22,"h":4},"17":{"x":8,"y":10,"w":4,"h":1},"18":{"x":8,"y":11,"w":4,"h":3},"19":{"x":13,"y":11,"w":3,"h":3},"20":{"x":16,"y":11,"w":3,"h":3},"21":{"x":13,"y":14,"w":8,"h":1},"22":{"x":13,"y":15,"w":3,"h":3},"23":{"x":0,"y":33,"w":12,"h":1},"24":{"x":0,"y":34,"w":22,"h":4},"25":{"x":0,"y":45,"w":22,"h":2},"26":{"x":15,"y":47,"w":7,"h":3},"27":{"x":8,"y":47,"w":7,"h":3},"28":{"x":0,"y":47,"w":8,"h":3},"29":{"x":8,"y":50,"w":14,"h":4},"30":{"x":0,"y":50,"w":8,"h":4},"31":{"x":0,"y":54,"w":22,"h":6},"32":{"x":0,"y":60,"w":24,"h":2},"33":{"x":0,"y":62,"w":22,"h":11},"36":{"x":0,"y":2,"w":22,"h":8},"37":{"x":0,"y":0,"w":10,"h":2},"38":{"x":0,"y":10,"w":8,"h":12}},"importedWithCode":false,"settings":{}}