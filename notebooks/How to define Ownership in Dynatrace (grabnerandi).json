{"version":"5","defaultTimeframe":{"from":"now-7d","to":"now","details":{"from":{"type":"expression","normalized":"now-7d","date":"2023-09-06T12:25:40.573Z"},"to":{"type":"expression","normalized":"now","date":"2023-09-13T12:25:40.573Z"}}},"sections":[{"id":"a5ccc628-7428-468f-8454-543025fb1665","type":"markdown","markdown":"# How to define Ownership in Dynatrace\nThis notebook provides best practices on defining ownership for monitored entities (hosts, processes, workloads, services ...). This feature allows you to not only see who owns a component but also allows targeted notifications as part of Workflows, e.g: send the right team a message in their slack channel when a problem comes up\n\n**Got questions or feedback?**: [devrel@dynatrace.com](mailto:devrel@dynatrace.com?subject=Feedback%20on%20Ownership)\n\n**Target Audience**: DevSecOps, Platform Engineers, SREs\n\n**Documentation and Videos**\n* [(Doc) Ownership](https://www.dynatrace.com/support/help/manage/ownership)\n* [(Video Tutorial)Ownership driven observability](https://www.youtube.com/watch?v=YSE5WvKHxWs)\n\n![](https://raw.githubusercontent.com/dynatrace-perfclinics/dynatrace-getting-started/main/images/howto_ownership_overview.png)","hasContent":true},{"id":"87219f8b-99bf-4b61-b5bf-d36fa31d3d6f","type":"markdown","markdown":"---"},{"id":"c550789b-34e2-43de-98f6-31640b085f4b","type":"markdown","markdown":"# Step 2: Assigning Ownership of entities to team\nAs we have created teams with a team identifier we can now assign those teams as owners to entities.\nTo learn more check out [How to assign owners to entities](https://www.dynatrace.com/support/help/manage/ownership/assign-ownership) and [Best practices on ownership assignment](https://www.dynatrace.com/support/help/manage/ownership/best-practices)\n\nIn this tutorial we cover the core use cases\n\n## Option 1: Through Kubernetes Labels\nFor Kubernetes deployments this is the best practice approach by defining the `dt.owner` label on deployments, namespaces, cronjobs, stateful or daemon sets.\n\n```\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: demo\n  labels:\n    dt.owner: my-team\nspec:\n```\n\nYou can also assign multiple teams as different teams may have different responsibilities:\n```\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: demo\n  labels:\n    dt.owner-1: my-team-1 # Dual team ownership defined for the Deployment\n    dt.owner-2: my-team-2\nspec:\n```\n\n## Option 2: Through Environment Variables\nAs ownership is managed through Tags we can also specify the owner information as an environment variable. Here we can either use `DT_TAGS` or `DT_CUSTOM_PROPS` in combination with an auto-tagging rule.\n\n## Option 3: Manually via Dynatrace UI\nYou can also assign teams to an entity on the entity screen in the owners section. Essentially this screen will create a tag called `owner` with the team identifier as its value:\n\n![](https://raw.githubusercontent.com/dynatrace-perfclinics/dynatrace-getting-started/main/images/howto_ownership_addmanually.png)"},{"id":"0a786b4f-1839-434b-989d-53e234e490b9","type":"markdown","markdown":"---"},{"id":"c0f65a02-1004-46cb-9197-b43af7111185","type":"markdown","markdown":"# Step 2: Use Ownership Information as part of a Workflow\nWhen installing the [Ownership App](https://www.dynatrace.com/support/help/manage/ownership/ownership-app) your workflows can extract ownership information which can be used for targeted workflows, e.g: sending messages to the team slack channel that is specified in the team configuration.\n\nFor more examples please watch [Ownership driven observability](https://www.youtube.com/watch?v=YSE5WvKHxWs) and read up on [Ownership App](https://www.dynatrace.com/support/help/manage/ownership/ownership-app)"},{"id":"ba631e03-e6ff-4fab-861b-01341d119efd","type":"markdown","markdown":"---"},{"id":"d3a15300-adbf-46e1-bf4a-c8115b6d5020","type":"markdown","markdown":"# Step 3: Query Ownership Information\nJust as with everything in Dynatrace we can also query entities based on Ownership information. \n\nHere is an example DQL to query all kubernetes workloads (cloud_application) that are owned by team ninja\n\n```\nfetch dt.entity.cloud_application\n| filter (isNotNull(tags) and indexOf(toString(tags),\"owner:ninja\")>=0) \n| fieldsAdd tags\n```"},{"id":"ea854e12-f636-443b-a363-541c1b95f845","type":"dql","title":"Kubernetes Workloads owned by Team Ninja","showTitle":false,"state":{"input":{"value":"fetch dt.entity.cloud_application\n| filter (isNotNull(tags) and indexOf(toString(tags),\"owner:Ninja\")>=0) \n| fieldsAdd tags","timeframe":{"from":"now-7d","to":"now","details":{"from":{"type":"expression","normalized":"now-7d","date":"2023-09-06T12:25:40.573Z"},"to":{"type":"expression","normalized":"now","date":"2023-09-13T12:25:40.573Z"}}}},"state":"success","davis":{"includeLogs":true},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"absolute"}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center"},"table":{"rowDensity":"condensed","enableLineWrap":true,"enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}}},"result":{"code":200,"value":{"records":[{"entity.name":"frontend","id":"CLOUD_APPLICATION-66BFF29866334A5A","tags":["dt.owner:Ninja"]},{"entity.name":"calculationservice","id":"CLOUD_APPLICATION-9C56C2DEB4AD5AA0","tags":["dt.owner:Ninja"]},{"entity.name":"adservice","id":"CLOUD_APPLICATION-CA2305D4EC324955","tags":["dt.owner:Ninja","dt.owner:KDTDemo"]}],"metadata":{"grail":{"canonicalQuery":"fetch dt.entity.cloud_application\n| filter isNotNull(tags) AND indexOf(toString(tags), \"owner:Ninja\") >= 0\n| fieldsAdd tags","timezone":"Europe/Berlin","query":"fetch dt.entity.cloud_application\n| filter (isNotNull(tags) and indexOf(toString(tags),\"owner:Ninja\")>=0) \n| fieldsAdd tags","scannedRecords":58,"dqlVersion":"V1_0","scannedBytes":7868,"analysisTimeframe":{"start":"2023-09-06T13:12:06.330Z","end":"2023-09-13T13:12:06.330Z"},"locale":"","executionTimeMilliseconds":69,"notifications":[],"queryId":"1d2471ef-0b23-45fc-86a0-dd42eaa4f7cc","sampled":false}},"types":[{"mappings":{"entity.name":{"type":"string"},"id":{"type":"string"},"tags":{"type":"array","types":[{"mappings":{"element":{"type":"string"}},"indexRange":[0,0]}]}},"indexRange":[0,1]},{"mappings":{"entity.name":{"type":"string"},"id":{"type":"string"},"tags":{"type":"array","types":[{"mappings":{"element":{"type":"string"}},"indexRange":[0,1]}]}},"indexRange":[2,2]}]},"notifications":[],"dateTime":"2023-09-13T13:12:06.329Z","input":{"value":"fetch dt.entity.cloud_application\n| filter (isNotNull(tags) and indexOf(toString(tags),\"owner:Ninja\")>=0) \n| fieldsAdd tags","timeframe":{"from":"now-7d","to":"now","details":{"from":{"type":"expression","normalized":"now-7d","date":"2023-09-06T12:25:40.573Z"},"to":{"type":"expression","normalized":"now","date":"2023-09-13T12:25:40.573Z"}}}}},"visualization":"table"},"height":189}]}